@inject Microsoft.ApplicationInsights.AspNetCore.JavaScriptSnippet JavaScriptSnippet
@using NetCoreCMS.Framework.Utility
@using NetCoreCMS.Framework.Core.Models
@using NetCoreCMS.Themes.Default.Lib
@using NetCoreCMS.Core.Modules.Cms
@using NetCoreCMS.Core.Modules.Cms.Models
@using NetCoreCMS.Core.Modules.Cms.Models.AccountViewModels
@using NetCoreCMS.Core.Modules.Cms.Models.ManageViewModels
@using Microsoft.AspNetCore.Identity
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers


@inject SignInManager<NccUser> SignInManager
@inject UserManager<NccUser> UserManager

@{
    int bodyClassWidth = 12;
    bool hasLeftColumn = false;
    bool hasRightColumn = false;
    var WebSite = GlobalConfig.WebSite;
    ViewBag.CurrentLayout = "SiteLayout";
}

<!DOCTYPE html>
<html>
    <head>
        @Html.Partial("Parts/_Head")
        @Html.Raw(JavaScriptSnippet.FullScript)
        @RenderSection("Styles", required: false)
    </head>
    <body id="body">
        <div id="loadingMask" class="loader loader-double"></div>

        <!-- Zone TOP Start-->
        <!-- Header -->
        @Html.Partial("Parts/_Header")    

        <!-- Navbar -->
        <nav id="mainNavbar" class="navbar navbar-default">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    @*<a asp-area="" asp-controller="CmsHome" asp-action="Index" class="navbar-brand">@WebSite.Name</a>*@
                    <div id="navbarWebsiteName" class="navbar-brand navbar-brand-with-top-menu">@WebSite.Name</div>
                </div>
                <div class="navbar-collapse collapse">
                    @Html.Raw(MenuHelper.PrepareMenuHtml("Navigation"))
                    <div class="userMenu">
                        @await Html.PartialAsync("_SiteLoginPartial")
                    </div>
                </div>
            </div>
        </nav>        
        <!-- Zone TOP End-->
        
        <!-- Full Width Slider Start -->
        @Html.Partial("Parts/_FullWidthSlider")
        <!-- Full Width Slider End -->

        <!--  Main Body Start -->
        <div class="container mainBody">   
            <!-- Left Column start -->
            @{
                var menusLeft = GlobalConfig.Menus.Where(x => x.Position == "LeftColumn").ToList();
                var zoneLeftWidgets = GlobalConfig.WebSiteWidgets.Where(x => x.Zone == "LeftSidebar" && x.LayoutName == ViewBag.CurrentLayout).ToList();
                if ((menusLeft != null && menusLeft.Count > 0) || (zoneLeftWidgets != null && zoneLeftWidgets.Count > 0))
                {
                    hasLeftColumn = true;
                    bodyClassWidth = bodyClassWidth - 2;
                }
                if (hasLeftColumn)
                {
                    Html.Partial("Parts/_LeftColumn");
                }

            }
            <!-- Left Column end -->

            <!-- Right Column start -->
            @{
                var menusRight = GlobalConfig.Menus.Where(x => x.Position == "RightColumn").ToList();
                var zoneRightWidgets = GlobalConfig.WebSiteWidgets.Where(x => x.Zone == "RightSidebar" && x.LayoutName == ViewBag.CurrentLayout).ToList();
                if ((menusRight != null && menusRight.Count > 0) || (zoneRightWidgets != null && zoneRightWidgets.Count > 0))
                {
                    hasRightColumn = true;
                    bodyClassWidth = bodyClassWidth - 2;
                }
                if (hasRightColumn)
                {
                    Html.Partial("Parts/_RightColumn");
                }

            }
            <!-- Right Column end -->

            <!-- Main content Start -->
            <div class="col-md-@bodyClassWidth">
                <!-- Featured Start -->
                @Html.Partial("Parts/_Featured")
                <!-- Featured End -->

                <!-- Container for showing global messages. -->
                <div class="row">
                    <div id="globalMessageContainer" class="ncc-global-message">

                    </div>
                </div>

                @RenderBody()
            </div>
            <!-- Main content End -->

        </div>
        <!--  Main Body End -->

        @Html.Partial("Parts/_Footer")

        @RenderSection("Scripts", required: false)

        @Html.Partial("Parts/_FooterScripts")
    </body>
</html>

