"use strict";function getBundles(n){return bundleconfig.filter(function(t){return n.test(t.outputFileName)})}var gulp=require("gulp"),concat=require("gulp-concat"),cssmin=require("gulp-cssmin"),htmlmin=require("gulp-htmlmin"),uglify=require("gulp-uglify"),merge=require("merge-stream"),del=require("del"),sass=require("gulp-sass"),bundleconfig=require("./bundleconfig.json"),regex={css:/\.css$/,html:/\.(html|htm)$/,js:/\.js$/},paths={webroot:"./wwwroot/"};paths.js=paths.webroot+"js/**/*.js";paths.minJs=paths.webroot+"js/**/*.min.js";paths.css=paths.webroot+"css/**/*.css";paths.minCss=paths.webroot+"css/**/*.min.css";paths.concatJsDest=paths.webroot+"js/site.min.js";paths.concatCssDest=paths.webroot+"css/site.min.css";gulp.task("min",["min:js","min:css","min:html"]);gulp.task("sass",function(){gulp.src("./wwwroot/*.scss").pipe(sass({outputStyle:"compressed"})).pipe(gulp.dest("./wwwroot/content/"))});gulp.task("min:js",function(){var n=getBundles(regex.js).map(function(n){return gulp.src(n.inputFiles,{base:"."}).pipe(concat(n.outputFileName)).pipe(uglify()).pipe(gulp.dest("."))});return merge(n)});gulp.task("min:css",function(){var n=getBundles(regex.css).map(function(n){return gulp.src(n.inputFiles,{base:"."}).pipe(concat(n.outputFileName)).pipe(cssmin()).pipe(gulp.dest("."))});return merge(n)});gulp.task("min:html",function(){var n=getBundles(regex.html).map(function(n){return gulp.src(n.inputFiles,{base:"."}).pipe(concat(n.outputFileName)).pipe(htmlmin({collapseWhitespace:!0,minifyCSS:!0,minifyJS:!0})).pipe(gulp.dest("."))});return merge(n)});gulp.task("clean",function(){var n=bundleconfig.map(function(n){return n.outputFileName});return del(n)});gulp.task("watch",function(){getBundles(regex.js).forEach(function(n){gulp.watch(n.inputFiles,["min:js"])});getBundles(regex.css).forEach(function(n){gulp.watch(n.inputFiles,["min:css"])});getBundles(regex.html).forEach(function(n){gulp.watch(n.inputFiles,["min:html"])})});